#!/usr/bin/env python
"Code generator, part of the build process."

brush_set_settings = ''
brush_get_settings = ''

s = open('brush.c').read()
s = s.split('brush_setting_infos[] = {')[-1]
s = s.split('};')[0]
i = 0
for line in s.split('\n'):
    line = line.strip()
    if line.startswith('{ "'):
        cname = line.split('"')[1]
        brush_set_settings += '  if (id == %d) { b->%s = value; } else\n' % (i, cname)
        brush_get_settings += '  if (id == %d) { return b->%s; } else\n' % (i, cname)
        i += 1

result = '''// autogenerated by generate.py, do not edit

void brush_set_setting (Brush * b, int id, float value)
{
''' + brush_set_settings + r'''
  {
    g_print ("brush_set_setting() with invalid id %d\n", id);
    g_assert (0);
  }
}

float brush_get_setting (Brush * b, int id)
{
''' + brush_get_settings + r'''
  {
    g_print ("brush_get_setting() with invalid id %d\n", id);
    g_assert (0);
    return 0;
  }
}

'''

open('brush_settings.inc', 'w').write(result)
